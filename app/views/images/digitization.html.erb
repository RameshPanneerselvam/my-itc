<script src="http:/assets/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/jquery-ui.min.js" type="text/javascript"></script>
            <link href="http:/assets/jquery-ui.css" rel="Stylesheet" type="text/css" />
<script type="text/javascript">
            var cid ;
            var pid ;
            $( window ).load(function(){
              var mm=$('#image1').html();

            var st=$('#image1').attr('id').match(/\d+/)[0];

cid=st.match(/\d+/)[0];
     var et=$("#image1").attr('class').match(/\d+/)[0];
     pid=parseInt(et);
     $('#ct').html(st+" "+"of"+" "+et);
     $('#s').attr('src', mm)
  
}); 

    $(document).ready(function(){
    $("td").click(function(){
     
     cid=$(this).attr('id').match(/\d+/)[0];
    
      
     var st=$(this).attr('id').match(/\d+/)[0];
     var et=$(this).attr('class').match(/\d+/)[0];
     pid=parseInt(et);
     var mm=$(this).html();

      
       $('#ct').html(st+" "+"of"+" "+et);
      
        $('#s').attr('src', mm)
        
       
    });
$("#plus").click(function(){
  
if (cid<pid)
{
  var id=parseInt(cid)+1;
  var mm=$('#image'+id).html();
var st=$('#image'+id).attr('id').match(/\d+/)[0];
var et=$("#image"+id).attr('class').match(/\d+/)[0];
var mm=$("#image"+id).html();
      
       $('#ct').html(st+" "+"of"+" "+et);
      
        $('#s').attr('src', mm)
        cid=id;

}
});

$("#minus").click(function(){
 
if (cid>=2)
{
  var id=parseInt(cid)-1;
  var mm=$('#image'+id).html();
var st=$('#image'+id).attr('id').match(/\d+/)[0];
var et=$("#image"+id).attr('class').match(/\d+/)[0];
var mm=$("#image"+id).html();
      
       $('#ct').html(st+" "+"of"+" "+et);
      
        $('#s').attr('src', mm)
        cid=id;
}



});


}); 
       
        
    </script>

   <style type="text/css">
   
   </style>
   </head>
  
  
<%if @classification != []%>

  <%=form_for @select_classification,:url=>{:controller=>"images",:action=>"digitization"} do |f|%>
     
    <div class="row">
      
      <div class="col-sm-2"><%= f.select "id",options_from_collection_for_select(@classification, "id", "classification_name"),{:include_blank=>"Select Option"},:class=>"form-control",:style=>"height: 3.5rem;",:required=>"true"%></div>

      <div class="col-sm-1"><button type="submit" class="btn btn-primary"><i class="fa fa-check-square-o" aria-hidden="true"></i> Select</button></div>
          
    </div><br>
  
  <%end%>
  
<%end%>
  
  
 
    <center><strong>Digitization(<%=$count%>)</strong></center>
                        
      

        <%if @all_image1 != []%>

          <%$head=[]%>
    
          <div class="col-md-12">
    
            <center><%=image_tag @all_image2.image_path,:class=>'zoom',:id=>"s",:style=>"height:300px; width:300px;"%></center><br><br>
                    
              <script src="/assets/wheelzoom.js"></script>
  
              <script>wheelzoom(document.querySelector('img.zoom'));</script>
          
            <div style="margin-left: 37%;" class="row">

              <div class="col-sm-2"><button id="minus" class="btn btn-primary"><<</button></div>

              <div class="col-sm-2"><h4 id="ct"></h4></div>

              <div class="col-sm-1"><button id="plus" class="btn btn-primary">>></button></div>
            
              <div class="col-sm-4"><a class="btn btn-default" data-toggle="modal" data-target="#applyModal1"><i class="fa fa-chevron-right" aria-hidden="true"></i> Skip</a></div>

              <%c=0%><%count=@all_image1.count%><div style="display:none;">
              <ul><% @all_image1.each do |img| %>  
              <%c+=1%><li style="width:26px;" id="image<%=c%>" class="images<%=count%>"><%= img.image_path%></li>
              <%end%></ul></div>
         
            </div> 
          </div>

            
       
              <%=link_to "Self_audit",images_self_audit_path%>

 <table class="table">
  <thead>
              <tr>
         
                <%@headers.map do |header|%>


            
                  <%$head << [FieldMaster.where(:id=>header.field_id).to_a[0].field_name,header.field_type]%>   

                  <th style="text-align: center;">

                    <%=FieldMaster.where(:id=>header.field_id).to_a[0].field_name%>

                  </th>

                <%end%>
             <th style="text-align: center;">Action</th>
              </tr>
              </thead>

<tbody style="height:80px;">
          
              <%t=1%>
        
              <%@datacapture.pluck(:group_id).uniq.map do |p|%>

                <tr>        
  
                  <%@datacapture.where(:group_id=>p).each do |field| %>
  
                    <td style="text-align: center;"><%=field.field_value%></td>
              
                  <%end%>
                  
                  <td><%=link_to "<button type='button' class='btn btn-primary btn-sm'><i class='fa fa-pencil' aria-hidden='true' ></i></button>".html_safe, images_sub_data_path(p)%></td>
        
                </tr>
    
              <%end%>
        
              <tr>   
        
                <%= form_for  @select_classification,:url=>{:controller=>"images",:action=>"create_digitization"} do |f| %>
             
                  <% $head.each do |field| %>

                    <td style="text-align: center;">        
                      
                      <%if field[1]== "Text"%>
                             
                        <%= text_field_tag field[0].to_sym,"",:style=>"width: 150px;",:class=>"form-control",:required=>""%>

                      <%elsif field[1] == "Date"%>

                        <%= text_field_tag field[0].to_sym, "",:class=>"txtTo",:style=>"width: 150px;",:required=>""%>

                      <%else%>

                        <%=select_tag "#{field[0]}", options_from_collection_for_select(Dropdownvalue.all, 'id', 'dropdownvalues_name' ),:class=>"form-control",:style=>"height: 3.5rem;"%>

                      <%end%>
  
                    </td>
              
                  <%end%>
                   
                 <td><button type="submit" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button></td> 

                <%end%>
       
              </tr> 
              </tbody>

            </table>

      
            <div class="modal fade" id="applyModal1" tabindex="-1" role="dialog" aria-labelledby="applyModalLabel" aria-hidden="true">

              <div class="modal-dialog modal-dialog_2">
   
                <div class="modal-content" style="margin-top: 180px;">
      
                  <div class="modal-header">
      
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
      
                    <h4 class="modal-title" id="myModalLabel">

                      <div class="head_4">
      
                        <div style="font-size: 100%; font-family: times;">Reasion for skip</div>
      
                      </div>
      
                    </h4>
     
                  </div>

                  <div class="modal-body">
      
                    <%= form_for @image_exception, :url=>{:controller=>"images", :action=>"save_remark"} do|i|%>
      
                      <div class="section">
      
                        <%= i.label :remarks_id,:style=>"font-family: t;"%>
                     
                        <%= i.select "id",options_from_collection_for_select(RemarkMaster.order("remark_name ASC"), "id", "remark_name"),{:include_blank=>"Select Option"},:class=>"form-control",:required=>"true", :style=>"height: 3.5rem;"%>
                     
                        <%= i.label :reason_for_exception,:style=>"font-family: t;"%>
                    
                        <%= i.text_area :reason_for_exception,:class=>"form-control",:id=>"input"%>
      
                      </div>

                      <div class="section">
                        <!--%= i.submit "Upload",:class=>"btn btn-success"%-->
                        <%= button_tag(type: "submit", :class=> "btn btn-sucess", :required=>"true") do %><i class="fa fa-arrow-up"></i> Register Remark<% end %>

                       <a class="btn btn-success" data-toggle="modal" data-target="#applyModal2"><i class="fa fa-plus "></i> Add new remark</a>
       
                    <%end%>
      
      
                      </div>
           
                      
                  </div>
      
                </div>
      
              </div>
    
            </div>
 
            <div class="modal fade" id="applyModal2" tabindex="-1" role="dialog" aria-labelledby="applyModalLabel" aria-hidden="true">

              <div class="modal-dialog modal-dialog_2">
   
                <div class="modal-content" style="margin-top: 180px;">
      
                  <div class="modal-header">
      
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
      
                    <h4 class="modal-title" id="myModalLabel">

                      <div class="head_4">
      
                        <div style="font-size: 100%; font-family: times;">Reasion for skip</div>
      
                      </div>
      
                    </h4>
     
                  </div>

                  <div class="modal-body">
      
                    <%= form_for @image_exception, :url=>{:controller=>"images", :action=>"save_remark"} do|i|%>
      
                      <div class="section">
      
                        <%= i.label :remarks_id,:style=>"font-family: t;"%>
                    
                        <%= i.text_field :remarks_id,:class=>"form-control",:id=>"input"%>

                        <%= i.label :reason_for_exception,:style=>"font-family: t;"%>
   
                        <%= i.text_area :reason_for_exception,:class=>"form-control",:id=>"input"%>
      
                      </div>

                      <div class="section" align="center">
       
                        <!--%= i.submit "Upload",:class=>"btn btn-success"%-->

                        <%= button_tag(type: "submit", :class=> "btn btn-sucess", :required=>"true") do %><i class="fa fa-arrow-up"></i> Add remark & Register<% end %>
                 
                      </div>
       
                    <%end%>
      
                  </div>
      
                </div>
       
              </div>

            </div>  
          
          
        
        <%else%>
      
          <%if @classification == []%>
  
            <h2>No Image to classification</h2>
        
          <%else%>
          
            <h2>No image in this classification please select another classification</h2>
        
          <%end%>

        <%end%>
    
    <!--/div-->

  <!--/div-->

       
 <script> $(function(){ $(".txtTo").datepicker({ dateFormat: 'yy-mm-dd' }); }); </script> 
<script type="text/javascript">
        function submitFrmAjax(){
          //var $inputs = $('#myForm :input');
          //var values = {};
          //$inputs.each(function() {
          //values[this.name] = $(this).val();
          //});

           $.ajax({
                url : "/images/subchild_update",
                data : $("#myForm").serialize(),
                dataType: 'json'
        
            });
        }
       
    
 
//$('#myForm').click(function() {

    // get all the inputs into an array.
  //  var $inputs = $('#myForm :input');

    // not sure if you wanted this, but I thought I'd add it.
    // get an associative array of just the values.
    //var values = {};
    //$inputs.each(function() {
     //   values[this.name] = $(this).val();
    //});

//function submit_of(){
  //window.location.href = '/images/subchild_update.23';
        //$.ajax({
          //  type        : 'GET',
            //url         : '/images/subchild_update.23',
           // data        : values,
            //dataType    : 'json',
            //encode          : true,
            
        //})
////});

 $(".datepick").datepicker();
 var newRowNum = 0;
//Read more: http://ssiddique.info/different-ways-to-add-row-to-a-table-using-jquery.html#ixzz4I7jQFEs5
function deleteRow(row)
{
    var i=row.parentNode.parentNode.rowIndex;
    document.getElementById('POITable').deleteRow(i);
}
 
 
function insRow()
{
    $(".datepick").datepicker("destroy");
    console.log( 'hi');
    var x=document.getElementById('POITable');
    var new_row = x.rows[1].cloneNode(true);
    var len = x.rows.length;
    new_row.cells[0].innerHTML = len;
 
    var inp1 = new_row.cells[1].getElementsByTagName('input')[0];
    inp1.id += len;
    inp1.value = '';
    var inp2 = new_row.cells[2].getElementsByTagName('input')[0];
    inp2.id += len;
    inp2.value = '';
    x.appendChild( new_row );

    $(".datepick").datepicker();

    $('#date', new_row).each(function(i) {
        var newID = 'date_' + newRowNum;
        $(this).attr('id', newID);

    });
}


//Read more: http://ssiddique.info/different-ways-to-add-row-to-a-table-using-jquery.html#ixzz4I7jTNbdq
// start a counter for new row IDs
// by setting it to the number
// of existing rows
/*$(".datepick").datepicker();
var newRowNum = 0;
var lid=1;
// bind a click event to the "Add" link
$('#addnew').click(function() {

    $(".datepick").datepicker("destroy");

    // increment the counter
    newRowNum = $(productTable).children('tbody').children('tr').length + 1;

    // get the entire "Add" row --
    // "this" refers to the clicked element
    // and "parent" moves the selection up
    // to the parent node in the DOM
    var addRow = $(this).parent().parent();
    

    // copy the entire row from the DOM
    // with "clone"
    var newRow = addRow.clone();

    // set the values of the inputs
    // in the "Add" row to empty strings
    $('input', addRow).val('');

    // insert a remove link in the last cell
    $('td:last-child', newRow).html('<a href="" class="remove"><i class="icon-minus"><\/i><\/a>');


    // insert the new row into the table
    // "before" the Add row
    addRow.before(newRow);


    $(".datepick").datepicker();

    // add the remove function to the new row
    $('a.remove', newRow).click(function() {
        $(this).closest('tr').remove();
        return false;
    });

    $('#date', newRow).each(function(i) {
        var newID = 'date_' + newRowNum;
        $(this).attr('id', newID);

    });

    // prevent the default click
    return false;
});

// remove's default rows
$('.removeDefault').click(function() {
    $(this).closest('tr').remove();
    return false;
});*/
</script>

<!--<script>
function newDoc() {
    window.location.assign("/images/subchild_update.23")
}
</script>
<input type="button" value="Load new document" onclick="newDoc()"-->


